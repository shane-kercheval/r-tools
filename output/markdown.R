# these functions are tailored towards GitHub markdown (https://guides.github.com/features/mastering-markdown/) so that the output
# of various analysis can be read directly via GitHub

#######################################################################################################################################
# header 1
#######################################################################################################################################
h1 <- function(text, postfix='')
{
	return (sprintf('# %s%s', text, postfix))
}

#######################################################################################################################################
# header 2
#######################################################################################################################################
h2 <- function(text, postfix='')
{
	return (sprintf('## %s%s', text, postfix))
}

#######################################################################################################################################
# header 3
#######################################################################################################################################
h3 <- function(text, postfix='')
{
	return (sprintf('### %s%s', text, postfix))
}

#######################################################################################################################################
# header 4
#######################################################################################################################################
h4 <- function(text, postfix='')
{
	return (sprintf('#### %s%s', text, postfix))
}

#######################################################################################################################################
# bold
#######################################################################################################################################
bold <- function(text, postfix='')
{
	return (sprintf('**%s**%s', text, postfix))
}

#######################################################################################################################################
# strike-through
#######################################################################################################################################
ital <- function(text, postfix='')
{
	return (sprintf('_%s_%s', text, postfix))
}

#######################################################################################################################################
# strike-through
#######################################################################################################################################
strike <- function(text, postfix='')
{
	return (sprintf('~~%s~~%s', text, postfix))
}

#######################################################################################################################################
# inline code
#######################################################################################################################################
code <- function(text, postfix='')
{
	return (sprintf('`%s`%s', text, postfix))
}

#######################################################################################################################################
# code block
#######################################################################################################################################
codeb <- function(text, postfix='', syntax='')
{
	return (sprintf('```%s\n%s\n```%s', syntax, text, postfix))
}

#######################################################################################################################################
# code block that calls print_c (which captures the output of `print(text)` and it returns it as a variable)
#######################################################################################################################################
codebc <- function(text, postfix='', syntax='')
{
	return (sprintf('```%s\n%s\n```%s', syntax, print_c(text), postfix))
}

#######################################################################################################################################
# block quote
#######################################################################################################################################
blockq <- function(text, postfix='')
{
	return (sprintf('> %s%s', text, postfix))
}

#######################################################################################################################################
# takes a matrix and converts it to a markdown table
#######################################################################################################################################
table_matrix <- function(a_matrix, title=NULL, row_header='Row', title_format=h1, title_postfix='\n', postfix='\n')
{
	table_markup = ''
	if(!is.null(title))
	{
		table_markup = title_format(title, postfix=title_postfix)
	}
	
	col_names = colnames(a_matrix)
	row_names = rownames(a_matrix)
	
	headers = c(row_header, col_names)
	header_markup = paste(headers, collapse = '|')
	header_separater = paste(rep('---',length(col_names)+1), collapse = '|')
	table_markup = sprintf('%s%s\n%s\n', table_markup, header_markup, header_separater)
	
	vals = apply(format(a_matrix, trim=TRUE), 1, paste, collapse="|")
	
	for (i in 1:length(row_names))
	{
		table_markup = sprintf('%s%s%s%s\n', table_markup, row_names[i], '|', vals[i])
	}
	table_markup = sprintf('%s%s', table_markup, postfix)
	return (table_markup)
}
